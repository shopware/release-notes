---
nav:
  title: v6.6.1.0
meta:
  date: "2024-04-08"
---
# Release notes Shopware 6.6.1.0

## Abstract

This patch release fixes a bug where snippets (language keys) have not been resolved, depending on which sales channel the cache was built. Additionally, we could optimize the caching mechanism.

## System requirements

* tested on PHP 8.2 and 8.3
* tested on MySQL 8 and MariaDB 10.11

## Improvements

### Staging Mode

We added a staging mode to Shopware, which helps you to mark a instance as a staging environment. This is useful for development and testing purposes. This allows to change the sales channel domain url, show a banner in the Administration or Storefront and many more. [Check out the docs for more about staging mode](https://developer.shopware.com/docs/guides/hosting/configurations/shopware/staging.html)

### HTML code element

The HTML code element is a new element in the Shopping Experiences. This element allows you to add custom HTML code to the Shopping Experience without conflicting with the HTML sanitization.

### Improved Elasticsearch/Opensearch logging

We changed the log_level to `error` for the Elasticsearch/Opensearch logging. This will reduce the amount of log entries in the log file in production mode.

### HTML sanitization optimization

The mail header and footer are not sanitized anymore. This allows you now to use any HTML tags in the mail header and footer.

The HTML sanitization now also supports all HTML5 tags and attributes.

### user:list command

We added a new command `user:list` to the CLI. This command lists all users in the system. This command have also a `--json` flag to interact with external tools like jq.

### Deprecation of dal:create:schema

The command `dal:create:schema` is deprecated and will be removed in the next major release. Please use as replacement the `dal:migration:create` command, this diffes your DAL schema to the current database and creates a migration file.

### Various OpenAPI schema improvements

We improved the OpenAPI schema in various places. We added missing properties, fixed wrong types and added missing descriptions.

### MediaService cleanups now the temporary created files

The MediaService now cleans up the temporary created files after the media has been processed.

### Store-api route to fetch media elements

Sometimes in custom fields or other fields are the media id stored, But you need in the Storefront the media url. We added a new route to fetch the media elements by media id.

```http
POST /store-api/media
Accept: application/json
sw-access-key: YOUR_ACCESS_KEY
Content-Type: application/json

{
    "ids" : [
        "018d8922df51736c98bec29c2d1f813f",
        "018d8923a32879cfadf561fb02c479e0"
    ]
}
```

### HMAC based JWT

Using private/public keys (asymmetric encryption) for JWT is now deprecated and will be removed with the next major release. Replacement for this is the HMAC based JWT, this allows us to use the existing `APP_SECRET` environment file and get rid of `config/jwt` folder. This makes hosting Shopware in a containerized environment a lot easier, as you don't need to mount the `config/jwt` folder anymore.

### Improved search on Product search in the administration

The search in the product listing in the administration is not considereing anymore category names and tag names attached to the products. This improves the search performance with MySQL a lot.

### Context::createDefaultContext is now internal

The method `Context::createDefaultContext` is now marked internal. With this decision we want to prevent that developers for wrong usage. In HTTP requests the context is created automatically and attached to the Request object. The only place where the Context is unknown is the `console` context. In this case you should use the `Context::createCLIContext` method.

### Spotlight Elements will replace Swagger UI

We deprecated the Swagger UI (`/api/_info/swagger.html`) and will replace it with the Spotlight Elements. The Spotlight Elements are a more modern and user-friendly way to interact with the API. The Spotlight Elements are available under `/api/_info/swagger.html`. This solves also the problem that the payload can't be shown in the Swagger UI.

### Improved s3 copy-speed

We imrpvoed the CopyBatch plugin to copy multiple files asynchronously. This improves the speed of the s3 copy operation a lot. This benefits `bin/console theme:compile` or `bin/console assets:install`

### Before

| Command                | Local | AWS S3  | Cloudflare R2 |
|------------------------|-------|---------|---------------|
| theme:compile          | 1.09s | 24.72s  | 91.30s        |
| asset:install --force* | 1.09s | 192.05s | 892.11s       |

### After

| Command                | Local | AWS S3  | Cloudflare R2 |
|------------------------|-------|---------|---------------|
| theme:compile          | 1.09s | 6.5s    | 17.91s        |
| asset:install --force* | 1.09s | 41.12s  | 141.38        |

- * the `asset:install` command uses a manifest file to only upload the changed files to the s3 bucket. The `--force` flag disables this feature and uploads all files, to have a better comparison.


## Fixed bugs





## More resources

* [Detailed diff on Github](https://github.com/shopware/shopware/compare/v6.6.0.3...v6.6.1.0) to the former version
* [Changelog on GitHub](https://github.com/shopware/shopware/blob/v6.6.1.0/CHANGELOG.md) for this version.
* [Installation overview](https://developer.shopware.com/docs/guides/installation/)
* [Update from a previous installation](https://developer.shopware.com/docs/guides/installation/template.html#update-shopware)

## Get in touch

Discuss about decisions, bugs you might stumble upon, etc in our [community slack](https://slack.shopware.com). See you there ;)
